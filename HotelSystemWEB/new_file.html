<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>

	<body>
		<script src="common/js/jQuery/jquery-3.2.1.js" type="text/javascript" charset="utf-8"></script>
		<script src="common/layui/layui.js" type="text/javascript" charset="utf-8"></script>
		<script src="common/js/CONFIG.js" type="text/javascript" charset="utf-8"></script>
		<script src="common/js/ZY.js" type="text/javascript" charset="utf-8"></script>
		<script src="reconnecting-websocket.js" type="text/javascript" charset="utf-8"></script>
		<script>
			var url = "ws://" + CONFIG.WS_URL
			var ws;
			if('WebSocket' in window) {
				ws = new ReconnectingWebSocket(url, null, {
					debug: true,
					maxReconnectAttempts: 4,
					reconnectInterval:5000
				});
			} else if('MozWebSocket' in window) { //兼容火狐
				ws = new MozWebSocket(url);
			} else { //兼容其他
				ws = new SockJS(url);
			}

			ws.onopen = function(evnt) {
				console.log("websocket连接上");
				ws.send("agentId#@#1#@#")
			};
			ws.onmessage = function(evnt) {
				console.log("[接收来自服务端的数据]:" + event.data)
			};
			ws.onerror = function(evnt) {
				console.log("websocket错误");
			};
			ws.onclose = function(evnt) {
				console.log("websocket关闭");
			}
		</script>
	</body>

</html>